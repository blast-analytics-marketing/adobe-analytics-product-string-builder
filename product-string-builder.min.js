//Minimized BlastAM Product String Builder Code v.070519
//This code has been thoroughly tested, but you'll want to do your own testing. You take full responsibility for its use. -- BlastAM
function buildProducts(t){for(var e="";void 0!==(product=t.shift());)""!==product.totalQuantity&&""!=product.totalPrice?e+=";"+product.sku+";"+product.totalQuantity+";"+product.totalPrice:Object.keys(product.evars).length||Object.keys(product.events).length?e+=";"+product.sku+";;":e+=";"+product.sku,e+=buildMerchEvents(product.events),e+=buildMerchEvars(e,product.evars),0!=t.length&&(e+=",");return e}function buildMerchEvents(t){var e=";",r=0;if(0==Object.keys(t).length)return"";for(key in t)r>0&&(e+="|"),e+=key+"="+t[key],r++;return e}function buildMerchEvars(t,e){var r=";",u=0;if(t=t.toLowerCase(),0==Object.keys(e).length)return"";for(key in-1==t.indexOf("event")&&(r+=";"),e)u>0&&(r+="|"),r+=key+"="+e[key],u++;return r}function Product(t,e,r,u,n){this.sku=void 0!==t&&""!==t?t:"",this.totalQuantity=void 0!==e&&""!==e?e:"",this.totalPrice=void 0===r||""===r||Number.isNaN(r)?"":r,this.evars=void 0!==u&&""!==u?u:{},this.events=void 0!==n&&""!==n?n:{},this.add=function(t,e){null!=typeof e&&null!=e&&"undefined"!=e&&"null"!=e&&((t=t.toLowerCase()).indexOf("evar")>-1?this.evars[t]=e:t.indexOf("event")>-1&&(this.events[t]=e))}}Number.isNaN=Number.isNaN||function(t){return"number"==typeof t&&isNaN(t)};
